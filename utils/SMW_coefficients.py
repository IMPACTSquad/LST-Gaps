import numpy as np


COEFFICIENTS = {
    "L4": {
        "A": [
            0.9755,
            1.0155,
            1.0672,
            1.1499,
            1.2277,
            1.3649,
            1.5085,
            1.7045,
            1.5886,
            2.0215,
        ],
        "B": [
            -205.2767,
            -233.8902,
            -257.1884,
            -286.2166,
            -316.7643,
            -361.8276,
            -410.1157,
            -472.4909,
            -442.9489,
            -571.8563,
        ],
        "C": [
            212.0051,
            230.4049,
            239.3072,
            244.8497,
            253.0033,
            258.5471,
            265.1131,
            270.7000,
            277.1511,
            279.9854,
        ],
    },
    "L5": {
        "A": [
            0.9765,
            1.0229,
            1.0817,
            1.1738,
            1.2605,
            1.4166,
            1.5727,
            1.7879,
            1.6347,
            2.1168,
        ],
        "B": [
            -204.6584,
            -235.5384,
            -261.3886,
            -293.6128,
            -327.1417,
            -377.7741,
            -430.0388,
            -498.1947,
            -457.8183,
            -600.7079,
        ],
        "C": [
            211.1321,
            230.0619,
            239.5256,
            245.6042,
            254.2301,
            259.9711,
            266.9520,
            272.8413,
            279.6160,
            282.4583,
        ],
    },
    "L7": {
        "A": [
            0.9764,
            1.0201,
            1.0750,
            1.1612,
            1.2425,
            1.3864,
            1.5336,
            1.7345,
            1.6066,
            2.0533,
        ],
        "B": [
            -205.3511,
            -235.2416,
            -259.6560,
            -289.8190,
            -321.4658,
            -368.4078,
            -417.7796,
            -481.5714,
            -448.5071,
            -581.2619,
        ],
        "C": [
            211.8507,
            230.5468,
            239.6619,
            245.3286,
            253.6144,
            259.1390,
            265.7486,
            271.3659,
            277.9058,
            280.6800,
        ],
    },
    "L8": {
        "A": [
            0.9751,
            1.0090,
            1.0541,
            1.1282,
            1.1987,
            1.3205,
            1.4540,
            1.6350,
            1.5468,
            1.9403,
        ],
        "B": [
            -205.8929,
            -232.2750,
            -253.1943,
            -279.4212,
            -307.4497,
            -348.0228,
            -393.1718,
            -451.0790,
            -429.5095,
            -547.2681,
        ],
        "C": [
            212.7173,
            230.5698,
            238.9548,
            244.0772,
            251.8341,
            257.2740,
            263.5599,
            268.9405,
            275.0895,
            277.9953,
        ],
    },
    "L9": {
        "A": [
            0.9751,
            1.0093,
            1.0539,
            1.1267,
            1.1961,
            1.3155,
            1.4463,
            1.6229,
            1.5396,
            1.9223,
        ],
        "B": [
            -206.2187,
            -232.7408,
            -253.4430,
            -279.1685,
            -306.7961,
            -346.5312,
            -390.7794,
            -447.2745,
            -427.0904,
            -541.7084,
        ],
        "C": [
            213.0526,
            230.9401,
            239.2572,
            244.2379,
            251.8873,
            257.2174,
            263.3479,
            268.5970,
            274.6380,
            277.4964,
        ],
    },
}


def mapped_SMWcoef(TPWpos, platform, coef):
    coefficients = np.zeros_like(TPWpos, dtype=np.float32)
    # make TPWpost numpy array astype int32 if not already
    if TPWpos.dtype != np.int32:
        TPWpos = TPWpos.astype(np.int32)
    for value in np.unique(TPWpos):
        coefficients[TPWpos == value] = COEFFICIENTS[platform][coef][value]
    return coefficients
